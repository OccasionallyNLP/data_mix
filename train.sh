export HF_HOME=/home/work/user/ocw
accelerate launch --num_processes 8 --mixed_precision bf16 train.py --dataset_path synthetic --tokenizer_name /home/work/user/ocw/models/pythia-1.4b-kt-tokenizer --config_name /home/work/user/ocw/models/pythia-1.4b-kt-tokenizer --per_device_train_batch_size 4 --per_device_eval_batch_size 1 --learning_rate 2e-4 --weight_decay 0.01 --max_train_steps 15000 --gradient_accumulation_steps 32 --lr_scheduler_type cosine_with_min_lr --num_warmup_steps 100 --output_dir ../output/data_mix/synthetic/pythia-1.4b-kt-tokenizer/fineweb_only --seed 42 --block_size 2048 --checkpointing_steps 1000 --min_learning_rate_ratio 0.1 --flash_attention --domain_weights_dict '{"fineweb":1.0,"cosmopedia":0.0}' --eval_domain_weights_dict '{"fineweb":0.5,"cosmopedia":0.5}'